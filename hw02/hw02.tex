\documentclass[fleqn]{homework}

\student{Stephen Brennan (smb196)}
\course{EECS 477}
\assignment{Homework 2}
\duedate{September 25, 2015}

\usepackage{mathtools}
\usepackage{multicol}
%\usepackage{graphicx}

\begin{document}
  \maketitle

  \begin{problem}{1}
    \begin{question}
      Solve problem 2(c) in homework assignment 1:\\
      Consider the following linear program:
      \begin{align*}
        \max 3x_1 - 5x_2 & \\
        \text{s.t.  } 4x_1 + 5x_2 &\ge 3 \\
        6(x_1 - x_2) &= 7 \\
        x_1 + 8x_2 &\le 20 \\
        x_1, x_2 &\ge 0
      \end{align*}
      \textbf{(c)} State the corresponding optimal basic solutions in terms of
      the matrices $\mathcal{B}$ and $\mathcal{L}$, and state the corresponding
      values of $\pi$.
    \end{question}

    From Homework 1, the standard form is:

    \begin{align*}
      \min -3x_1 + 5x_2 & \\
      \text{s.t. } 4x_1 + 5x_2 - x_3 &= 3 \\
      6x_1 - 6x_2 &= 7 \\
      x_1 + 8x_2 + x_4 &= 20 \\
      x_1, x_2, x_3, x_4 &\geq 0
    \end{align*}

    And the solution is
    $x^{*T} = (\frac{7}{6}, 0, \frac{7}{6}, 18 \frac{5}{6})$.  So, the
    corresponding basic variables (nonzero) are $x_1, x_3, x_4$.  Therefore, we
    have the matrices $B$ and $L$:

    \begin{equation}
      B = \begin{bmatrix*} 4 & -1 & 0 \\ 6 & 0 & 0 \\ 1 & 0 & 1 \end{bmatrix*},\:\:
      L = \begin{bmatrix*} -1 \\ 0 \\ 0 \end{bmatrix*}
    \end{equation}

    This means that the solution in terms of $B$ and $L$ is
    $x_B^T = (x_1, x_3, x_4) = (\frac{7}{6}, \frac{7}{6}, 18 \frac{5}{6})$, and
    $x_L^T = (x_2) = (0)$.

    In order to determine the corresponding values of $\pi$, we use the equation
    $\pi^T = c_B^T B^{-1}$.  First, we compute $B^{-1}$:

    \begin{equation}
      B^{-1} = \begin{bmatrix*} -5 & 0 & -1 \\ -7 & -1 & -1 \\ -2 & -1 & -2 \end{bmatrix*}
    \end{equation}

    From this, we can compute that $\pi^T = (15, 0, 3)$.
  \end{problem}

  \begin{problem}{2}
    \begin{question}
      Consider the following linear programs:
      \begin{multicols}{3}
      \noindent \textbf{Program 1}
      \begin{align*}
        \max x_1 + 2x_2 & \\
        \text{s.t.  } x_1 + x_2 &\le 5 \\
        6x_1 - 3x_2 &\le3 \\
        5x_1 &\le 24 \\
        6x_2 &\le 9 \\
        x_1, x_2 &\ge 0
      \end{align*}
      \textbf{Program 2}
      \begin{align*}
        \min x_1 + x_3 & \\
        \text{s.t.  } x_1 + 2x_2 &\le 5 \\
        x_1 + 2x_3 &= 6 \\
        x_1, x_2, x_3 &\ge 0
      \end{align*}
      \textbf{Program 3}
      \begin{align*}
        \max 3x_1 - 5x_2 & \\
        \text{s.t.  } 4x_1 + 5x_2 &\ge 3 \\
        6(x_1 - x_2) &= 7 \\
        x_1 + 8x_2 &\le 20 \\
        x_1, x_2 &\ge 0 \\
      \end{align*}
      \textbf{Program 4}
      \begin{align*}
        \max 3x_1 + 2x_2 + 5x_3 & \\
        \text{s.t.  } 5x_1 + 3x_2 + x_3 &= -8 \\
        4x_1 + 2x_2+ 8x_3 &\le 23 \\
        6x_1 + 7x_2 + 3x_3 &\ge 1 \\
        x_1 \le 4, x_3 &\ge 0
      \end{align*}
      \textbf{Program 5}
      \begin{align*}
        \min c & \\
        \text{s.t.  } x_1 + 2x_2 + \frac{x_3}{2} &\le c \\
        3x_1 + 2x_2 + x_3 &\le c \\
        x_1 + x_2 + x_3 &= 1 \\
        x_1, x_2, x_3 &\ge 0
      \end{align*}
      \end{multicols}
      For each of these programs:\\
      \textbf{(a)} Find an optimal solution x*, if any. Octave allowed.\\
      \textbf{(b)} Find the dual of the linear program and write the
      complementary slackness conditions.\\
      \textbf{(c)} Find an optimal solution y* of the dual such that (x*, y*)
      satisfy complementary slackness. Show your work.  Octave allowed. (If the
      primal is infeasible or unbounded, you can skip this step.)
    \end{question}

    \textbf{Program 1: (a)} According to Octave, $x^{*T} = (1.25, 1.5)$, and
    $z^* = 4.25$.  \textbf{(b)} The dual is:

    \begin{align*}
      \min 5\pi_1 + 3\pi_2 + 24\pi_3 + 9\pi_4 &\\
      \text{s.t. } \pi_1 + 6\pi_2 + 5\pi_3 &\ge 1 \\
      \pi_1 - 3\pi_2 + 6\pi_4 &\ge 2\\
      \pi_1, \pi_2, \pi_3, \pi_4 &\ge 0\\
    \end{align*}

    The complimentary slackness conditions are:

    \begin{align*}
      x_1 = 0 &\text{ or } \pi_1 + 6\pi_2 + 5\pi_3 = 1 \\
      x_2 = 0 &\text{ or } \pi_1 - 3\pi_2 + 6 \pi_4 = 2 \\
      \pi_1 = 0 &\text{ or } x_1 + x_2 = 5 \\
      \pi_2 = 0 &\text{ or } -6x_1 + 3x_2 = -3 \\
      \pi_3 = 0 &\text{ or } -5x_1 = -24 \\
      \pi_4 = 0 &\text{ or } -6x_2 = -9 \\
    \end{align*}

    \textbf{(c)} Using the complementary slackness conditions:

    \begin{align*}
      \pi_1 = 0 &\text{ or } 1.25 + 1.5 = 5 \\
      \pi_2 = 0 &\text{ or } -6*1.25 + 3*1.5 = -3 \\
      \pi_3 = 0 &\text{ or } -5*1.25 = -24 \\
      \pi_4 = 0 &\text{ or } -6*1.5 = -9 \\
    \end{align*}

    We see that $\pi_1$ and $\pi_3$ must be zero.  We substitute this into the
    complementary slackness conditions on $x$:

    \begin{align*}
      6\pi_2 &= 1 \\
      -3\pi_2 + 6 \pi_4 &= 2 \\
    \end{align*}

    So, $\pi_2 = \frac{1}{6}$, and then $\pi_4 = -\frac{1}{4}$.  Therefore, we
    have $\pi^{*T} = (0, \frac{1}{6}, 0, -\frac{5}{12})$.

    \textbf{Program 2: (a)} According to Octave, $x^{*T} = (0, 0, 3)$, and
    $z^* = 3$.  \textbf{(b)} The dual is:

    \begin{align*}
      \max -5\pi_1 + 6\pi_2 &\\
      \text{s.t. } -\pi_1 + \pi_2 &\le 1 \\
      -2\pi_1 &\le 1 \\
      2\pi_2 &\le 0 \\
      \pi_1 &\ge 0 \\
      \pi_2 &\text{ unconstrained}
    \end{align*}

    The complementary slackness conditions are:

    \begin{align*}
      x_1 = 0 &\text{ or } -\pi_1 + \pi_2 = 1 \\
      x_2 = 0 &\text{ or } -2\pi_1 = 1 \\
      x_3 = 0 &\text{ or } 2\pi_2 = 0 \\
      \pi_1 = 0 &\text{ or } -x_1 - 2x_2 = -5 \\
      \pi_2 = 0 &\text{ or } x_1 + 2x_3 = 6 \\
    \end{align*}

    \textbf{(c)} Using the complementary slackness conditions and the $x^*$:

    \begin{align*}
      \pi_1 = 0 &\text{ or } 0 = -5 \\
      \pi_2 = 0 &\text{ or } 2*3 = 6 \\      
    \end{align*}

    So $\pi_1 = 0$.  Applying the complementary slackness condition for $x_3$,
    $\pi_2 = 0$ as well.  Therefore, we have $\pi^{*T} = (0, 0)$.

    \textbf{Program 3: (a)} According to Octave, $x^{*T} = (1.167, 0)$, and
    $z^* = 3.5$.  \textbf{(b)} The dual is:

    \begin{align*}
      \min -3 \pi_1 + 7 \pi_2 + 20 \pi_3 &\\
      \text{s.t. } -4\pi_1 + 6\pi_2 + \pi_3 &\ge 3 \\
      -5\pi_1 - 6\pi_2 + 8\pi_3 &\ge -5 \\
      \pi_1, \pi_3 &\ge 0 \\
      \pi_2 &\text{ unconstrained}
    \end{align*}

    The complementary slackness conditions are:

    \begin{align*}
      x_1 = 0 &\text{ or } -4\pi_1 + 6\pi_2 + \pi_3 = 3 \\
      x_2 = 0 &\text{ or } -5\pi_1 - 6\pi_2 + 8\pi3 = 0 \\
      \pi_1 = 0 &\text{ or } -4x_1 - 5x_2 = -3 \\
      \pi_2 = 0 &\text{ or } 6x_1 - 6x_2 = 7 \\
      \pi_3 = 0 &\text{ or } x_1 + 8x_2 = 20 \\
    \end{align*}

    \textbf{(c)} Using the complementary slackness conditions and $x$:

    \begin{align*}
      \pi_1 = 0 &\text{ or } -\frac{28}{6} - 5*0 = -3 \text{ (false)} \\
      \pi_2 = 0 &\text{ or } 6*\frac{7}{6} - 6*0 = 7 \text{ (true)} \\
      \pi_3 = 0 &\text{ or } \frac{7}{6} + 8*0 = 20 \text{ (false)} \\
    \end{align*}

    So, $\pi_1 = 0$ and $\pi_3 = 0$.  We plug this into the conditions for $x_1$
    and see $6\pi_2 = 3$, so $\pi_2 = \frac{1}{2}$.  So,
    $\pi^{*T} = (0, \frac{1}{2}, 0)$.  This makes the dual's objective function
    $3.5$, which matches the primal's, so these are an optimal pair.

    \textbf{Program 4: (a)} According to Octave, the primal is infeasible.
    \textbf{(b)} The dual is:

    \begin{align*}
      \min -8\pi_1 + 23\pi_2 - \pi_3 + 4\pi_4 &\\
      \text{s.t. } 5\pi_1 + 4\pi_2 - 6\pi_3 + \pi_4 &= 3 \\
      3\pi_1 + 2\pi_2 - 7\pi_3 &= 2 \\
      \pi_1 + 8\pi_2 - 3\pi_3 &\ge 5 \\
      \pi_2, \pi_3, \pi_4 &\ge 0 \\
      \pi_1 &\text{ unconstrained}
    \end{align*}

    The complementary slackness constraints are:

    \begin{align*}
      x_1 = 0 &\text{ or } 5\pi_1 + 4\pi_2 - 6\pi_3 + \pi_4 = 3 \\
      x_2 = 0 &\text{ or } 3\pi_1 + 2\pi_2 - 7\pi_3 = 2 \\
      x_3 = 0 &\text{ or } \pi_1 + 8\pi_2 - 3\pi_3 = 5 \\
      \pi_1 = 0 &\text{ or } 5x_1 + 3x_2 + x_3 = -8 \\
      \pi_2 = 0 &\text{ or } 4x_1 + 2x_2 + 8x_3 = 23 \\
      \pi_3 = 0 &\text{ or } -6x_1 - 7x_2 - 3x_3 = -1 \\
      \pi_4 = 0 &\text{ or } x_1 = 4 \\
    \end{align*}

    \textbf{Program 5: (a)} According to Octave, $x_1 = 0$, $x_2 = 0$,
    $x_3 = 1$, $c = 1$.

  \end{problem}

  \begin{problem}{3}
    \begin{question}
      Write the dual and the complementary slackness conditions of the knapsack
      instance at Homework Assignment 1, problem 4.
    \end{question}
  \end{problem}

  \begin{problem}{4}
    \begin{question}
      Write the dual and the complementary slackness conditions of the
      contractor problem (Homework Assignment 1, problem 7).
    \end{question}
  \end{problem}

  \begin{problem}{5}
    \begin{question}
      Consider the following linear program:
      \begin{align*}
        \min x_1 + x_2 + 3x_3 + 2x_4 + 4x_5 & \\
        \text{s.t. } x_1 + x_3 + x_5 &= 2 \\
        x_4 - x_3 &= 1 \\
        x_2 - x_1 &= -1 \\
        x_2 + x_4 + x_5 &= 2 \\
        0 \le x_1 &\le 1 \\
        0 \le x_2 &\le 2 \\
        0 \le x_3 &\le 1 \\
        0 \le x_4 &\le 3 \\
        0 \le x_5 &\le 2 \\
      \end{align*}
      \textbf{(a)} Show that every basic feasible solution is integer.\\
      \textbf{(b)} Find an optimal basic feasible solution x* (octave allowed).\\
      \textbf{(c)} Find the dual of the linear program and write the
      complementary slackness conditions.\\
      \textbf{(d)} Find an optimal solution y* of the dual such that $(x*, y*)$
      satisfy complementary slackness. Show your work.\\
    \end{question}
  \end{problem}

  \begin{problem}{6}
    \begin{question}
      Given a set of $m$ linear inequalities on the $n$ variables
      $x_1, x_2, \dots, x_n$, the \textit{linear inequality feasibility problem}
      asks if there is a setting of the variables that simultaneously satisfies
      all the inequalities. This question asks you to prove that linear
      programming reduces to the linear inequality feasibility problem.

      \textbf{(a)} Show that if we have an algorithm for linear programming, we
      can use it to solve the linear inequality feasibility problem. The number
      of variables and constraints that are used in the linear program should be
      polynomial in $n$ and $m$.

      \textbf{(b)} Conversely, show that if we have an algorithm for the linear
      inequality feasibility problem, we can use it to solve linear
      programming. The values of $n$ and $m$ should be polynomial in the number
      of variables and constraints in the linear program.
    \end{question}

    \textbf{(a)} Given a set of linear inequalities, we can create a linear
    programming problem as follows

    \begin{align*}
      &\min 0 \\
      &\text{s.t.  the given inequalities}
    \end{align*}

    We use our linear programming algorithm to solve this.  There is no way for
    this linear program to be unbounded, so if the LP algorithm fails, the
    inequalities are infeasible.  If the LP algorithm succeeds, the inequalities
    are feasible and the optimal solution returned is a feasible setting of the
    variables for the LIF problem.

    \textbf{(b)} Assume that the linear programming problem is given in standard
    form: $\min c^T x$, s.t. $Ax=b$.  We will solve this with LIF by creating a
    system of linear inequalities on the vector $y$ such that $y^T=(x^T,\pi^T)$
    for the primal and dual of this problem.  The inequalities will impose the
    following constraints on $y$:

    \begin{itemize}
    \item The $x$ portion of $y$ must satisfy the constraints of the original
      LP.  That is, $Ax = b$.  Expressed as inequalities, this becomes
      $Ax \le b$, $Ax \ge b$, and $x \ge 0$.
    \item The $\pi$ portion of $y$ must satisfy the constraints of the dual to
      the LP.  That is, $A^T \pi = c$.  Expressed as inequalities, this becomes
      $A^T \pi \le c$, $A^T \pi \ge c$, and $x \ge 0$.
    \item Taken together, $x$ and $\pi$ must satisfy strong duality.  That is,
      $b^T \pi - c^T x = 0$.  Expressed as inequalities, this becomes
      $b^T \pi - c^T x \ge 0$ and $b^T \pi - c^T x \le 0$.
    \end{itemize}

    We can write this as a single matrix inequality:

    \begin{equation}
      \begin{bmatrix*}[r]
        A & 0 \\ 
        -A & 0 \\
        I & 0 \\
        0 & A^T \\
        0 & -A^T \\
        0 & I \\
        -c^T & b^T \\ 
        c^T & -b^T 
      \end{bmatrix*}
      \begin{bmatrix*} 
        x \\ \pi
      \end{bmatrix*} \ge
      \begin{bmatrix*}[r]
        b \\ -b \\ \vec{0} \\ c \\ -c \\ \vec{0} \\ 0 \\ 0
      \end{bmatrix*}
    \end{equation}

    The constraints of the first point are the first three rows, the constraints
    of the second point are the next three rows, and the constraints of the
    third point are the final two rows.  Any solution to this set of
    inequalities will satisfy the constraints of the primal, the constraints of
    the dual, and also the strong duality constraints.  Therefore, it will be a
    pair $(x,\pi)$ of optimal solutions to the primal and dual.
  \end{problem}

  \begin{problem}{7}
    \begin{question}
      Consider the minimum cost network flow problem defined on the following
      network G=(V, E). The node set V consists of the six nodes a, b, c, d, e,
      and f. Each node has a capacity, which is defined as the maximum amount of
      flow that can cross that node. The nodes have supplies and capacities as
      per the following table:

      \begin{tabular}{rrr}
        \hline
        Node & $b_i$ & capacity \\
        \hline
        $a$ & 20 & 25 \\
        $b$ & 5 & 35 \\
        $c$ & -15 & 30 \\
        $d$ & -10 & 10 \\
        $e$ & 0 & 20 \\
        \hline
      \end{tabular}

      The network has six arcs, whose costs, lower bounds, and upper bounds are
      as follows:

      \begin{tabular}{rrrr}
        \hline
        Arc & $c$ & $l$ & $u$ \\
        \hline
        $(a, b)$ & 4 & 5 & $\infty$ \\
        $(a, c)$ & 6 & 3 & $\infty$ \\
        $(b, c)$ & -2 & 0 & 25 \\
        $(b, e)$ & 5 & 0 & 10 \\
        $(c, d)$ & -3 & 5 & 10 \\
        $(e, d)$ & 2 & 0 & $\infty$ \\
        \hline
      \end{tabular}

      \textbf{(a)} Draw an equivalent minimum cost network flow problem on a
      network in which nodes have no capacities, arc lower bounds are zero, arc
      upper bounds are infinity, and costs are positive.

      \textbf{(b)}Show that the following flow is feasible, and draw the
      corresponding residual network:

      \begin{tabular}{rr}
        \hline
        Arc & Flow \\
        \hline
        $(a, b)$ & 20 \\
        $(a, c)$ & 0 \\
        $(b, c)$ & 25 \\
        $(b, e)$ & 0 \\
        $(c, d)$ & 10 \\
        $(e, d)$ & 0 \\
        \hline
      \end{tabular}

    \end{question}
  \end{problem}

\end{document}